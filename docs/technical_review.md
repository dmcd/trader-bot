# Technical Review

## Architecture / Maintainability
- [] `trader_bot/strategy_runner.py` is a 1.8k+ line monolith mixing orchestration, risk gating, exchange reconciliation, plan management, telemetry, and fee/PnL accounting. The main loop performs synchronous SQLite writes and blocking ccxt calls, making it hard to test and reason about. Consider splitting into services (data fetching, execution, risk gating, plan monitor, telemetry/persistence) with clearer contracts and unit coverage.
- [ ] Strategy execution, risk, and DB concerns are tightly coupled: the runner calls DB methods directly from many paths, while `RiskManager` holds mutable state but depends on the runner to hydrate prices. A clearer boundary (e.g., an `ExposureService` fed by normalized market snapshots) would simplify tests and reduce duplicated price lookups.
- [ ] The LLM strategy builds prompts and tools inline but the runner still fetches its own market data and OHLCV separately. A single data provider interface would reduce duplication and make unit tests deterministic.
- [ ] SQLite access uses a shared connection with `check_same_thread=False` but no locking; multiple async tasks call into the DB concurrently (equity logging, trade syncing, plan updates) which risks intermittent failures and partial writes.